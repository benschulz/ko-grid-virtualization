/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function p(e,x){return function(f){return f}(function(f,q,g){g.defineExtension("ko-grid-virtualization",{s:function(h){h.before("body").insert('<tbody class="ko-grid-virtualization-before-spacer"><tr data-bind="style: { height: extensions.virtualization.__beforeHeight() + \'px\' }"><td></td></tr></tbody>');h.after("body").insert('<tbody class="ko-grid-virtualization-after-spacer"><tr data-bind="style: { height: extensions.virtualization.__afterHeight() + \'px\' }"><td></td></tr></tbody>')},q:function(h,
f,a){function g(){a.data.limit(Math.ceil((k.clientHeight-1)/c)+1);m()}function e(){var d=k.scrollTop,b=Math.floor((r+(d-t))/c),b=a.data.offset()+b;t=d;l=b&1;b-=l;r=l*c+d%c;a.data.offset(b);m()}function m(){var d=k.scrollTop,b=Math.max(0,a.data.view.filteredSize()-a.data.offset()-a.data.limit())*c,g=k.clientHeight,e=u.getBoundingClientRect(),f=v.getBoundingClientRect(),h=f.top-e.bottom-(d-n());window.console.log("contentHeight: "+h+", bbb: "+e.bottom+", abt: "+f.top);n(d-l*c-d%c);w(Math.max(0,b+h-
g))}var n=q.observable(0),w=q.observable(0);this.__beforeHeight=n;this.__afterHeight=w;var k,u,v;a.postApplyBindings(function(){k=a.element.querySelector(".ko-grid-table-scroller");u=a.element.querySelector(".ko-grid-virtualization-before-spacer");v=a.element.querySelector(".ko-grid-virtualization-after-spacer");a.data.view.filteredSize.subscribe(m);a.layout.afterRelayout(g);k.addEventListener("scroll",e)});var c=25,t=0,r=0,l=0}});return g.declareExtensionAlias("virtualization","ko-grid-virtualization")}({},
x,e))}"function"===typeof define&&define.amd?define(["ko-grid","knockout","ko-data-source","ko-indexed-repeat"],p):window["ko-grid-virtualization"]=p(window.ko.bindingHandlers.grid,window.ko);